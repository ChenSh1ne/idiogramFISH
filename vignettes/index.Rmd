---
title: "idiogramFISH: Installation and minimal examples"
author: "Fernando Roa"
date: "23 08 2019"

pkgdown:
  as_is: true
output:
  prettydoc::html_pretty:
    theme: leonids
    highlight: github
    toc: true
    toc_depth: 1
    number_sections: true
    pandoc_args: ["--lua-filter=refs/multiple-bibliographies.lua"]
    
bibliography_normal: [refs/allrefs.bib,refs/iqtree.bib,refs/revbayes.bib]
bibliography_software: [refs/packages.bib, refs/idiogramFISH.bib]
bibliography_docs: [refs/docPackages.bib, refs/Rrefs.bib, refs/docPackages2.bib]

csl: refs/clima5.csl
link-citations: yes
# nocite: |
#   @R-dplyr
#self_contained: yes
# mode: selfcontained
resource_files:
  - refs/multiple-bibliographies.lua
  - refs/allrefs.bib
  - refs/iqtree.bib
  - refs/revbayes.bib
  - refs/packages.bib
  - refs/idiogramFISH.bib
  - refs/Rrefs.bib
  - refs/docPackages.bib
  - refs/docPackages2.bib
  - refs/clima5.csl
  - ../man/figures/cranversion.svg
  - ../man/figures/crandownload.svg
  - ../man/figures/donate2.svg
  - ../man/figures/donateweek.svg
  - ../man/figures/gitbadge.svg
  - ../man/figures/dfOfChrSize.svg
  - ../man/figures/doibadge.svg
  - ../man/logo.svg
  - css/mystyle.css
vignette: >
  %\VignetteIndexEntry{idiogramFISH: Installation and minimal examples}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

``` {r, results="asis", echo=FALSE, message=FALSE}
# <!-- pkgdown --> 
# <!-- jquery --><script src="js/jquery.min.js" crossorigin="anonymous"></script>
myfile<-"js/jquery.min.js"
if(file.exists(myfile)){
cat(paste0('<script src="',myfile,'" crossorigin="anonymous"></script> <!-- # -->'))
}
# <!-- clipboard.js --><script src="js/clipboard.min.js"  crossorigin="anonymous"></script>
myfile<-"js/clipboard.min.js"
if(file.exists(myfile)){
cat(paste0('<script src="',myfile,'"crossorigin="anonymous"></script>'))
}
# <!-- Font Awesome icons --><link rel="stylesheet" href="css/all.minMod.css"  crossorigin="anonymous">
myfile<-"css/all.minMod.css"
if(file.exists(myfile)){
cat(paste0('<link rel="stylesheet" href="',myfile,'"  crossorigin="anonymous">'))
}
# <!-- Bootstrap --><link rel="stylesheet" href="css/bootstrap.minO.css" crossorigin="anonymous">
myfile<-"css/bootstrap.minO.css"
if(file.exists(myfile)){
cat(paste0('<link rel="stylesheet" href="',myfile,'"  crossorigin="anonymous">'))
}
# <!-- # <script src="js/bootstrap.min.js"  crossorigin="anonymous"></script> -->
myfile<-"js/bootstrap.min.js"
if(file.exists(myfile)){
cat(paste0('<script src="',myfile,'" crossorigin="anonymous"></script> <!-- # -->'))
}
myfile<-"js/pkgdown2.js"
if(file.exists(myfile)){
cat(paste0('<script src="',myfile,'"></script> <!-- # -->'))
}
library(knitr)
```
<link rel="stylesheet" href="css/mystyle.css">


<!-- <div class="aright"> -->
<div class="goright">
Go to [1. Monocentrics Vignette](AplotIdiogramsVig.html)  
Go to [2. Holocentrics Vignette](BplotIdiogramsHoloVig.html)  
Go to [3. Groups Vignette](CgroupsVig.html)  
Go to [4. Phylogeny Vignette](DphylogenyVig.html)  
Go to [5. Human Vignette](EhumanVig.html)  

<!-- # there are 2 spaces at the end of those lines -->
</div>

# idiogramFISH: Idiograms with Marks and Karyotype Indices

```{r, echo=F,  results="asis"}
img1_path <- "../man/logo.svg"
if(file.exists(img1_path)) {
cat(paste0("<img src=",img1_path," class=\"right\" width=\"20%\">") )
}
```


<!-- <img src='man/logo.png' align="right" height="120" /> -->

<!-- badges: start -->

```{r, include = FALSE}
 badge_devel_gitlab<-function(pkg, color){
    v <- rvcheck:::check_github_gitlab(pkg, "gitlab")$latest_version
    url <- paste0("https://gitlab.com/", pkg)
    badger::badge_custom("devel version", v, color, url)
 }
```

The goal of idiogramFISH is to plot idiograms of several karyotypes having a set of data.frames for chromosome data
    and optionally marks' data (`plotIdiograms`) [@Roa2020].<br>
    <br>Marks can have square or dot form, its legend (label) can be drawn inline 
    or to the right of karyotypes. It is possible to calculate
    also chromosome and karyotype indexes [@Watanabe1999;@Zarco1986new] and classify chromosomes by morphology [@Guerra1986d; @Levan1964].
    
IdiogramFISH was written in R [@R-base] and also uses crayon [@R-crayon], plyr [@plyr2011] and dplyr packages [@R-dplyr]. Documentation was written with R-packages roxygen2 [@R-roxygen2], usethis [@R-usethis], bookdown [@bookdown2016], knitr [@Xie2015], pkgdown [@R-pkgdown], Rmarkdown [@rmarkdown2018], rvcheck [@R-rvcheck], badger [@R-badger], kableExtra [@R-kableExtra], prettydoc [@R-prettydoc] and RCurl [@R-RCurl]. For some vignette figures, packages phytools [@phytools2012], ggtree [@ggtree2018], ggplot2 [@ggplot22016] and ggpubr [@R-ggpubr] were used. 

# Installation

## You can install idiogramFISH from [CRAN](https://cran.r-project.org/package=idiogramFISH) with: {-}

``` {r, echo=F, message=FALSE, fig.show = "hold", fig.align = "default", results="asis"}
# was ``` {r, echo=F, fig.show = "hold", fig.align = "default"}
# library(badger)

if (requireNamespace("RCurl", quietly = TRUE)  ) {
  
cranversion <- "https://www.r-pkg.org/badges/version/idiogramFISH?color=orange"
cranversion_cont <- tryCatch(suppressWarnings(RCurl::getURLContent(cranversion) ), error=function(e) NA )

  if (!is.na(cranversion_cont)){
  cranversion_contFile <- "../man/figures/cranversion.svg"
  writeLines(cranversion_cont, con = cranversion_contFile)
  cranversion_contFile <- normalizePath(cranversion_contFile)
  # knitr::include_graphics(cranversion_contFile)
  cat(paste0("![''](",knitr::include_graphics(cranversion_contFile),")" ) )
  } # cran version

# tryCatch(cat(paste(badger::badge_cran_release("idiogramFISH", "orange")  ,"&nbsp;" ) ), error=function(e) return("") )  
# tryCatch(cat(paste(badger::badge_cran_download("idiogramFISH", type="grand-total", color="orange") ) ), error=function(e) return("") )
# ``` 
# ``` {r, echo=F, message=FALSE, fig.show = "hold", fig.align = "default", results="asis"}
# library(badger)
  
crandownloads<-"https://cranlogs.r-pkg.org/badges/grand-total/idiogramFISH?color=orange"
crandownloads_cont <- tryCatch(suppressWarnings(RCurl::getURLContent(crandownloads) ), error=function(e) NA )

  if (!is.na(crandownloads_cont)){
  crandownloads_contFile <- "../man/figures/crandownload.svg"
  writeLines(crandownloads_cont, con = crandownloads_contFile)
  crandownloads_contFile <- normalizePath(crandownloads_contFile)
  
  cat(paste0("&nbsp;![''](",knitr::include_graphics(crandownloads_contFile),")" ) )
  #   this gives ERROR WHEN DEVTOOLS INSTALL IN WINDOWS.
  # cat(paste0("&nbsp;![''](",crandownloads,")" ) )
  } # cran down

doibadge <- "https://zenodo.org/badge/DOI/10.5281/zenodo.3579417.svg"
doibadge_cont      <- tryCatch(suppressWarnings(RCurl::getURLContent(doibadge)      ), error=function(e) NA )

  if (!is.na(doibadge_cont)){
  doibadge_contFile <- "../man/figures/doibadge.svg"
  writeLines(doibadge_cont, con = doibadge_contFile)
  doibadge_contFile <- normalizePath(doibadge_contFile)
  
  cat(paste0("&nbsp;[![DOI](",knitr::include_graphics(doibadge_contFile)         ,")](https://doi.org/10.5281/zenodo.3579417)" ) )
  #cat(paste0("&nbsp;[![DOI](https://zenodo.org/badge/DOI/10.5281/zenodo.3579417.svg)](https://doi.org/10.5281/zenodo.3579417)" ) )
  } # doi

} # rcurl
```

``` r
install.packages("idiogramFISH")
```
 
## Or the devel version {-}

``` {r, echo=F, message=FALSE, warning=FALSE, include=T}
if (requireNamespace("RCurl", quietly = TRUE)  ) {
v<-tryCatch(suppressWarnings(rvcheck:::check_github_gitlab("ferroao/idiogramFISH", "gitlab")$latest_version), error=function(e) NA )
link<-tryCatch(suppressWarnings(badger::badge_custom("devel version", v, "green") ), error=function(e) NA )
if(!is.na(link)){
svglink<-gsub("\\[|\\]|!|\\(|\\)","", link)
gitbadge_cont <- tryCatch(suppressWarnings(RCurl::getURLContent(svglink) ), error=function(e) NA )
if (!is.na(gitbadge_cont)){
# gitbadge_contFile <- tempfile(fileext = ".svg")
gitbadge_contFile <- "../man/figures/gitbadge.svg"
writeLines(gitbadge_cont, con = gitbadge_contFile)
gitbadge_contFile <- normalizePath(gitbadge_contFile)
knitr::include_graphics(gitbadge_contFile)
}
}
}
```

<!-- # ``` {r, echo=F, results="asis", message=FALSE, warning=F, include=T} -->
<!-- # cat(gitbadge) -->
<!-- # ```  -->


### From gitlab with devtools [@R-devtools] : {-}

Attention windows users, please install [Rtools](https://cran.r-project.org/bin/windows/Rtools/) and [git](https://git-scm.com/download/win).

Vignettes use a lua filter, so you would need [pandoc](https://pandoc.org/installing.html) ver. > 2. `rmarkdown::pandoc_version()`

``` {r, eval=FALSE}
# This installs package devtools, necessary for installing the dev version
install.packages("devtools")

url <- "https://gitlab.com/ferroao/idiogramFISH"
```
``` {r, eval=FALSE}
# Necessary packages for vignettes:
list.of.packages <- c(
    "knitr",
    "kableExtra",
    "prettydoc",
    "rmarkdown",
    "RCurl",
    "rvcheck",
    "badger"
    )
new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
if(length(new.packages)) install.packages(new.packages)
```

``` {r, eval=FALSE}
# Linux with vignettes and Windows 
devtools::install_git(url = url,build_vignettes = TRUE, force=TRUE)
```

``` {r, eval=FALSE}
# Mac with vignettes
devtools::install_git(url = url, build_opts=c("--no-resave-data","--no-manual") )
```

### Or install it in terminal: {-}

``` {r, eval=FALSE}
# clone repository:
git clone "https://gitlab.com/ferroao/idiogramFISH"

R CMD build idiogramFISH
# install
R CMD INSTALL idiogramFISH_*.tar.gz
```

# What's new in gitlab? 

[ver. > 1.0.0](https://gitlab.com/ferroao/idiogramFISH/blob/master/NEWS.md)

## Releases: {-}

[Gitlab releases](https://gitlab.com/ferroao/idiogramFISH/-/releases) 

# Need help?

## Manual {-}

[online Manual](https://ferroao.gitlab.io/manualidiogramfish/)

## Documentation {-}

[pkgdown style](https://ferroao.gitlab.io/idiogramFISH)

## Vignettes: {-}

Online:

[Monocentrics](https://ferroao.gitlab.io/idiogramfishhelppages/AplotIdiogramsVig.html)  
[Holocentrics](https://ferroao.gitlab.io/idiogramfishhelppages/BplotIdiogramsHoloVig.html)  
[Groups of chromosomes](https://ferroao.gitlab.io/idiogramfishhelppages/CgroupsVig.html)   
[Alongside Phylogeny](https://ferroao.gitlab.io/idiogramfishhelppages/DphylogenyVig.html)  
[Human karyotype](https://ferroao.gitlab.io/idiogramfishhelppages/EhumanVig.html)  

Launch vignettes from R for the installed version:
``` r
browseVignettes("idiogramFISH")
packageVersion("idiogramFISH")
```

# Basic examples

## How to plot a karyotype: {-}

Define your plotting window size with something like `par(pin=c(10,6))`, or with `svg()`, `png()`, etc.
Add chromosome morphology according to [Guerra](https://ferroao.gitlab.io/guerra1986/Guerra1986.pdf) [-@Guerra1986d] or [@Levan1964]

```{r example, echo=T, results="hide", message=FALSE, dev='svg'}
# fig.width=10, fig.height=6

library(idiogramFISH)

data(dfOfChrSize) # chromsome data
data(dfMarkColor) # mark general data
data(dfOfMarks2)  # mark position data (inc. cen.)

svg("dfOfChrSize.svg",width=12,height=8 )
plotIdiograms(dfChrSize=dfOfChrSize,    # data.frame of chr. size
              dfMarkColor=dfMarkColor,  # d.f of mark style <- Optional
              dfMarkPos=dfOfMarks2,     # df of mark positions (includes cen. marks)
              
              morpho="Guerra",          # chr. morpho. classif. (Guerra, Levan, both, "" ) ver. >= 1.12 only
              chrIndex="CI",            # cen. pos. (CI, AR, both, "" ) ver. >= 1.12 only
              
              rulerPos=-.9,             # position of rulers
              ruler.tck=-0.01,          # size and orientation of ruler ticks
              rulerNumberSize=.8        # font size of rulers
              
              ,legendWidth=1            # width of legend items
              ,distTextChr = .5         # chr. text separation
              
              ,xlimLeftMod = 2          # xlim left param.
              ,ylimBotMod = 0           # modify ylim bottom argument
              ,ylimTopMod = 0           # modify ylim top argument
              ,asp=1                    # y/x aspect, see ?plot
)
dev.off()
```

```{r, results="asis", comment=NA, echo=FALSE}
# cat(paste0("![](dfOfChrSize.png)" ) )
cat(paste0("![](dfOfChrSize.svg)" ) )
```

##  Let's explore the data.frames for monocentrics: {-}

```{r monocentrics, comment=NA}

# chromsome data, if only 1 species, column OTU is optional
dfOfChrSize
# mark general data
dfMarkColor 
```

`p, q` and `w` marks can have empty columns `markDistCen` and `markSize` since v. 1.9.1 to plot whole arms (`p`, `q`) and whole chr. `w`.


```{r, comment=NA}
# mark position data, if only 1 species, column OTU is optional
dfOfMarks2
```

## How to plot a karyotype of holocentrics: {-}

function `plotIdiogramsHolo` deprecated after ver. > 1.5.1

```{r example2, echo=T, results="hide", fig.width=10, fig.height=6, message=FALSE}
library(idiogramFISH)

# load some package data.frames
data(dfChrSizeHolo, dfMarkColor, dfMarkPosHolo)

# plotIdiogramsHolo is deprecated
par(mar = c(0, 0, 0, 0), omi=rep(0,4), oma=rep(0,4) )
# svg("testing.svg",width=14,height=8 )
plotIdiograms(dfChrSize=dfChrSizeHolo, # data.frame of chr. size
              dfMarkColor=dfMarkColor, # df of mark style
              dfMarkPos=dfMarkPosHolo, # df of mark positions
              addOTUName=FALSE,        # do not add OTU names
              
              distTextChr = .5,        # chr. name distance to chr.
              
              rulerPos=-.9,            # position of ruler
              rulerNumberPos=.9,       # position of numbers of rulers
              
              xlimLeftMod=2,           # modify xlim left argument of plot
              ylimBotMod=.2            # modify ylim bottom argument of plot
              ,legendHeight=.5         # height of legend labels
              ,legendWidth = 1.2       # width of legend labels
              ,asp=1)                  # y/x aspect
# dev.off() # close svg()
```


## Let's explore the data.frames for holocentrics: {-}

```{r holocentrics, comment=NA}
# chromsome data, if only 1 species, column OTU is optional
dfChrSizeHolo
# mark general data
dfMarkColor 
# mark position, if only 1 species, column OTU is optional
dfMarkPosHolo
```


## Plotting both mono. and holo. {-}

Available only for ver. > 1.5.1  

Merge data.frames with `plyr` [@plyr2011]

```{r, echo=T,  comment=NA, results="hide", message=FALSE}
# chromosome data, if only 1 species, column OTU is optional
require(plyr)
dfOfChrSize$OTU   <- "Species mono"
dfChrSizeHolo$OTU <- "Species holo"
 
monoholoCS <- plyr::rbind.fill(dfOfChrSize,dfChrSizeHolo)

dfOfMarks2$OTU     <-"Species mono"
dfOfMarks2[which(dfOfMarks2$markName=="5S"),]$markSize<-.7
dfMarkPosHolo$OTU <-"Species holo"

monoholoMarks <- plyr::rbind.fill(dfOfMarks2,dfMarkPosHolo)
```

```{r, echo=T, results="hide", message=FALSE, dev='svg'}
library(idiogramFISH)
# load some saved data.frames

# function plotIdiogramsHolo deprecated for ver. > 1.5.1

#svg("testing.svg",width=14,height=10 )
png("monoholoCS.png", width=700, height=500)
par(mar=rep(0,4))
plotIdiograms(dfChrSize  = monoholoCS,   # data.frame of chr. size
              dfMarkColor= dfMarkColor,  # df of mark style
              dfMarkPos  = monoholoMarks,# df of mark positions, includes cen. marks
              
              roundness = 4,             # vertices roundness
              addOTUName = TRUE,         # add OTU names
              distTextChr = .5,          # separ. among chr. and text and among chr. name and indices
              
              karHeiSpace = 3,           # karyotype height inc. spacing
              karIndexPos = .2,          # move karyotype index
              
              legendHeight= 1,           # height of legend labels
              legendWidth = 1,           # width of legend labels
              
              rulerPos= -0.5,            # position of ruler
              ruler.tck=-0.02,           # size and orientation of ruler ticks
              rulerNumberPos=.9,         # position of numbers of rulers
              
              xlimLeftMod=1,             # modify xlim left argument of plot
              xlimRightMod=3,            # modify xlim right argument of plot
              ylimBotMod= .2             # modify ylim bottom argument of plot
              ,asp=1                     # y x aspect ratio
)
dev.off()
```

```{r, results="asis", comment=NA, echo=FALSE}
cat(paste0("![](monoholoCS.png)" ) )
```

## Plotting GISH results {-}

Available only for ver. > 1.8.3  

```{r, echo=T, results="hide", fig.width=10, fig.height=9, message=FALSE}
library(idiogramFISH)
# load some saved data.frames

par(mar=rep(0,4))

# svg("allo.svg",width=10,height=9 )
plotIdiograms(dfChrSize = parentalAndHybChrSize,  # d.f. of chr. sizes
              dfMarkPos = dfAlloParentMarks,      # d.f. of marks' positions
              cenColor  = NULL                    # cen. color when GISH
              
              ,karHeiSpace=5,                     # karyotype height including spacing
              karSepar = FALSE,                   # equally sized karyotypes       
              
              rulerPos=-1,                        # ruler position
              ruler.tck= -0.002,                  # ruler tick orientation and length
              rulerNumberSize=.5                  # ruler font size
              ,legend=""                          # no legend
              ,asp=1                              # y x aspect ratio

              ,ylimBotMod = 1                     # modifiy ylim bottom argument
              ,xlimRightMod = 0                   # modify xlim right argument
              
)
#dev.off() # close svg()
```

## Let's explore the data.frames for GISH:

```{r, comment=NA, echo=FALSE}
cat("parentalAndHybChrSize")
```

```{r, comment=NA, echo=F}
print(parentalAndHybChrSize, row.names=F)
```

Use `p` for short arm, `q` for long arm, and `w` for whole chromosome mark.

```{r, comment=NA, echo=FALSE}
cat("dfAlloParentMarks")
```

```{r gish2, comment=NA, echo=F}
print(dfAlloParentMarks, row.names=F)
```

# Citation

```{r citation, echo=FALSE, comment=NA,results='asis'} 
print(citation("idiogramFISH"),bibtex=FALSE )
```

To write citation to file:
```{r, echo=TRUE, results=FALSE, eval=FALSE}
sink("idiogramFISH.bib")
toBibtex(citation("idiogramFISH"))
sink()
```

# Authors

[Fernando Roa](https://ferroao.gitlab.io/curriculumpu/)
``` {r, echo=F, message=FALSE, fig.show = "hold", fig.align = "default", results="asis"}
# library(badger)
if (requireNamespace("RCurl", quietly = TRUE)  ) {
# donate_cont <- tryCatch(RCurl::getURLContent(donate), error=function(e) NA )
# if (!is.na(donate_cont)){
# donate_contFile <- "../man/figures/donate.svg"
# # donate_contFile <- tempfile(fileext = ".svg")
# writeLines(donate_cont, con = donate_contFile)
# cat(paste0("[![donate](",knitr::include_graphics(donate_contFile),")](https://liberapay.com/ferroao/donate)" ) )
# }
donate <- "https://liberapay.com/assets/widgets/donate.svg"
donate_contFile <- "../man/figures/donate2.svg"
tryCatch(suppressWarnings(download.file(donate, donate_contFile) ), error=function(e) "")
if(file.exists(donate_contFile ) ) {
cat(paste0("[![donate](",knitr::include_graphics(donate_contFile),")](https://liberapay.com/ferroao/donate)" ) )
}
}
```
``` {r, echo=F, message=FALSE, fig.show = "hold", fig.align = "default", warning=FALSE, results="asis"}
# library(badger)
if (requireNamespace("RCurl", quietly = TRUE) ) {
donateweek <- "http://img.shields.io/liberapay/receives/ferroao.svg"
donateweek_contFile <- "../man/figures/donateweek.svg"
tryCatch(suppressWarnings(download.file(donateweek, donateweek_contFile) ), error=function(e) "")
if(file.exists(donateweek_contFile ) ) {
cat(paste0("[![donate](",knitr::include_graphics(donateweek_contFile),")](https://liberapay.com/ferroao/donate)" ) )
}
}
```
  
[Mariana PC Telles](http://lattes.cnpq.br/4648436798023532)  

```{r include=FALSE,eval=FALSE}
# automatically create a bib database for R packages, this is currently not used by vignette refs/packages2.bib
knitr::write_bib(c(
  .packages(), 'bookdown', 'knitr', 'rmarkdown',"devtools","pkgdown","crayon","ggtree","ggplot2","ggpubr","phytools","plyr","dplyr"
), 'refs/packages2.bib')
```

`r if (knitr:::is_html_output()) '
# References {-}
'`
::: {#refs_normal}
:::

# R-packages references {-}

::: {#refs_software}
:::

# Documentation references {-}

::: {#refs_docs}
:::
